<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Bubble Shooter</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <!-- Three.js for 3D bubble rendering -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/examples/js/postprocessing/ShaderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/examples/js/postprocessing/UnrealBloomPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/examples/js/shaders/FXAAShader.js"></script>
</head>
<body>
    <div class="game-container">
        <h1>Bubble Shooter</h1>
        
        <!-- Settings Gear Icon -->
        <button class="settings-gear" id="settingsGear">
            <div class="gear-icon">‚öôÔ∏è</div>
        </button>
        
        <!-- Settings Popup -->
        <div class="settings-popup" id="settingsPopup">
            <div class="settings-header">
                <h3>Settings</h3>
                <button class="close-btn" id="closeSettings">‚úï</button>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-icon">üéµ</span>
                        <span class="setting-text">Music</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="musicToggle" checked>
                            <span class="slider"></span>
                        </div>
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <span class="setting-icon">üîä</span>
                        <span class="setting-text">Sound Effects</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="soundToggle" checked>
                            <span class="slider"></span>
                        </div>
                    </label>
                </div>
                <div class="player-id-section">
                    <div class="player-id-label">Player ID</div>
                    <div class="player-id-value" id="playerIdDisplay">BS-2025-001</div>
                </div>
            </div>
        </div>
        
        <!-- Settings Overlay -->
        <div class="settings-overlay" id="settingsOverlay"></div>
        
        <div class="game-menu" id="gameMenu">
            <!-- Horizontal Leaderboard -->
            <div class="horizontal-leaderboard">
                <h2>üèÜ Top Players</h2>
                <div class="leaderboard-scroll" id="horizontalLeaderboard">
                    <!-- Players will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="menu-section">
                <h2>Difficulty</h2>
                <div class="button-group">
                    <button class="game-button active" data-difficulty="novice">Novice</button>
                    <button class="game-button" data-difficulty="easy">Easy</button>
                    <button class="game-button" data-difficulty="medium">Medium</button>
                    <button class="game-button" data-difficulty="hard">Hard</button>
                    <button class="game-button" data-difficulty="master">Master</button>
                </div>
            </div>
            <button id="startGame" class="play-button">Play</button>
            <button id="showLeaderboard" class="leaderboard-button">Leaderboard</button>
        </div>
        
        <!-- Bottom Navigation Bar -->
        <div class="bottom-nav">
            <button class="nav-item" id="dailyChallenge">
                <div class="nav-icon">üèÜ</div>
                <div class="nav-label">Daily Challenge</div>
            </button>
            <button class="nav-item active" id="homeNav">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">Home</div>
            </button>
            <button class="nav-item" id="shopNav">
                <div class="nav-icon">üõí</div>
                <div class="nav-label">Shop</div>
            </button>
        </div>
        
        <div class="game-screen" id="gameScreen" style="display: none;">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            <div class="game-controls">
                <button id="backToMenu" class="control-button">Menu</button>
                <button id="toggleSound" class="control-button">Sound: On</button>
            </div>
            <div class="instructions">
                <p>Click to shoot bubbles! Match 3 or more of the same color to pop them.</p>
                <p>Use the walls to reach difficult spots. Clear all bubbles to win!</p>
            </div>
        </div>
        
        <div class="leaderboard" id="leaderboard" style="display: none;">
            <h2>High Scores</h2>
            <table id="scoresTable">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Score</th>
                        <th>Difficulty</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody id="scoresList">
                    <!-- Scores will be inserted here by JavaScript -->
                </tbody>
            </table>
            <button id="backToMenuFromLeaderboard" class="control-button">Back to Menu</button>
        </div>
    </div>
    <!-- Load dependencies first -->
    <script src="bubbleRenderer3D.js"></script>
    <script src="bubbleTrailRenderer.js"></script>
    <script src="bubbleRenderer.js"></script>
    <!-- Main game script -->
    <script src="game.js?v=11"></script>
    <!-- Debug script (optional) -->
    <script src="debug_shooting.js"></script>
</body>
</html>